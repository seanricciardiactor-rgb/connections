<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Connections</title>
  <style>
    :root{
      --bg:#f6f6f4;
      --card:#ffffff;
      --text:#1a1a1a;
      --muted:#666;
      --border:#d9d9d9;

      --yellow:#f5df6b;
      --green:#bfe3a8;
      --blue:#a9d6f5;
      --purple:#d6b0f3;

      --tile:#efefee;
      --tileText:#111;
      --selected:#111;
      --selectedText:#fff;
      --shadow: 0 1px 0 rgba(0,0,0,.06);
      --radius: 14px;
      --tileRadius: 12px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--font);
      background:var(--bg);
      color:var(--text);
      display:flex;
      justify-content:center;
    }

    .wrap{
      width:min(760px, 100%);
      padding:18px 14px 40px;
    }

    /* Faux NYT-ish header (no logos) */
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:8px 6px 14px;
    }
    header .left, header .right{
      display:flex; gap:10px; align-items:center;
      color:var(--muted);
      font-size:14px;
    }
    .pill{
      border:1px solid var(--border);
      background:#fff;
      padding:8px 10px;
      border-radius:999px;
      box-shadow:var(--shadow);
      user-select:none;
    }
    h1{
      margin:0;
      font-size:22px;
      letter-spacing:.5px;
      font-weight:700;
    }
    .sub{
      margin:2px 0 0;
      color:var(--muted);
      font-size:13px;
    }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
    }

    .topSolved{
      display:grid;
      gap:10px;
      margin-bottom:14px;
    }
    .group{
      border-radius:12px;
      padding:14px 14px 12px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:14px;
      border:1px solid rgba(0,0,0,.06);
    }
    .group .meta{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width: 150px;
    }
    .group .label{
      font-weight:800;
      text-transform:uppercase;
      font-size:12px;
      letter-spacing:.9px;
    }
    .group .title{
      font-size:16px;
      font-weight:700;
      line-height:1.15;
    }
    .group .words{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      justify-content:flex-end;
      flex:1;
    }
    .chip{
      background: rgba(255,255,255,.55);
      border: 1px solid rgba(0,0,0,.10);
      padding:6px 10px;
      border-radius:999px;
      font-size:13px;
      font-weight:650;
      white-space:nowrap;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
    }

    button.tile{
      border:1px solid rgba(0,0,0,.10);
      background:var(--tile);
      color:var(--tileText);
      border-radius:var(--tileRadius);
      padding:16px 10px;
      min-height:58px;
      font-weight:800;
      letter-spacing:.3px;
      text-transform:uppercase;
      box-shadow:var(--shadow);
      cursor:pointer;
      transition: transform .06s ease, background .12s ease, color .12s ease;
      user-select:none;
    }
    button.tile:active{ transform: scale(.99); }
    button.tile.selected{
      background:var(--selected);
      color:var(--selectedText);
      border-color:rgba(0,0,0,.35);
    }
    button.tile.locked{
      opacity:.45;
      cursor:not-allowed;
    }

    .controls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:14px;
      align-items:center;
      justify-content:space-between;
    }
    .btnRow{
      display:flex; gap:10px; flex-wrap:wrap;
    }
    .btn{
      border:1px solid var(--border);
      background:#fff;
      color:#111;
      border-radius:999px;
      padding:10px 14px;
      font-weight:700;
      cursor:pointer;
      box-shadow:var(--shadow);
    }
    .btn.primary{
      background:#111;
      color:#fff;
      border-color:#111;
    }
    .btn:disabled{
      opacity:.5;
      cursor:not-allowed;
    }
    .status{
      color:var(--muted);
      font-size:13px;
    }
    .toast{
      margin-top:12px;
      font-size:14px;
      font-weight:650;
      color:#111;
      display:none;
      padding:10px 12px;
      background:#fff7cc;
      border:1px solid rgba(0,0,0,.10);
      border-radius:12px;
    }
    .toast.show{ display:block; }
    .shake{
      animation: shake .28s ease-in-out 0s 1;
    }
    @keyframes shake{
      0%{ transform: translateX(0); }
      25%{ transform: translateX(-6px); }
      50%{ transform: translateX(6px); }
      75%{ transform: translateX(-4px); }
      100%{ transform: translateX(0); }
    }

    .reveal{
      margin-top:16px;
      padding:18px 16px;
      border-radius:14px;
      border:1px solid rgba(0,0,0,.10);
      background: #fff;
      display:none;
      text-align:center;
    }
    .reveal.show{ display:block; }
    .reveal h2{
      margin:0 0 8px;
      font-size:22px;
      letter-spacing:.2px;
    }
    .reveal p{
      margin:0;
      color:var(--muted);
      font-weight:600;
    }

    @media (max-width: 520px){
      button.tile{ padding:14px 8px; min-height:54px; font-size:12px; }
      .group{ flex-direction:column; align-items:flex-start; }
      .group .words{ justify-content:flex-start; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="left">
        <div class="pill">Games</div>
        <div class="pill">Daily Puzzle</div>
      </div>
      <div style="text-align:center;">
        <h1>Connections</h1>
        <div class="sub" id="dateLine"></div>
      </div>
      <div class="right">
        <div class="pill" id="streak">Streak: 1</div>
        <div class="pill">?</div>
      </div>
    </header>

    <div class="card" id="card">
      <div class="topSolved" id="solved"></div>

      <div class="grid" id="grid"></div>

      <div class="controls">
        <div class="btnRow">
          <button class="btn" id="shuffleBtn">Shuffle</button>
          <button class="btn" id="deselectBtn">Deselect all</button>
        </div>
        <div class="btnRow">
          <button class="btn primary" id="submitBtn" disabled>Submit</button>
          <button class="btn" id="newBtn">New puzzle</button>
        </div>
      </div>

      <div class="status" id="status">Select 4 words, then submit.</div>
      <div class="toast" id="toast"></div>

      <div class="reveal" id="reveal">
        <h2>üíç Will you marry me?</h2>
        <p>(When she looks up‚Ä¶ you do the rest üòÑ)</p>
      </div>
    </div>
  </div>

  <script>
    // --- Custom puzzle data ---
    const CATEGORIES = [
      { color: "yellow", title: "Valentine‚Äôs Day", words: ["Heart","Red","Chocolate","Flowers"] },
      { color: "green",  title: "2nd Date Movies", words: ["Goofy","Jerk","Spaceballs","Cats Don‚Äôt Dance"] },
      { color: "blue",   title: "Jesus Meals",     words: ["Diet Coke","Movie Pretzel","Diet Ginger Ale","Eggplant Parm"] },
      { color: "purple", title: "So Much",         words: ["Will","You","Marry","Me"] }
    ];

    const COLOR_MAP = {
      yellow: getComputedStyle(document.documentElement).getPropertyValue('--yellow').trim(),
      green:  getComputedStyle(document.documentElement).getPropertyValue('--green').trim(),
      blue:   getComputedStyle(document.documentElement).getPropertyValue('--blue').trim(),
      purple: getComputedStyle(document.documentElement).getPropertyValue('--purple').trim()
    };

    let remaining = [];
    let selected = new Set();
    let solved = [];
    let lockedWords = new Set();

    const gridEl = document.getElementById('grid');
    const solvedEl = document.getElementById('solved');
    const submitBtn = document.getElementById('submitBtn');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const deselectBtn = document.getElementById('deselectBtn');
    const newBtn = document.getElementById('newBtn');
    const toast = document.getElementById('toast');
    const statusEl = document.getElementById('status');
    const revealEl = document.getElementById('reveal');
    const cardEl = document.getElementById('card');

    // Date line
    const dateLine = document.getElementById('dateLine');
    const now = new Date();
    dateLine.textContent = now.toLocaleDateString(undefined, { weekday:'long', month:'long', day:'numeric' });

    function initPuzzle() {
      solved = [];
      selected = new Set();
      lockedWords = new Set();
      remaining = CATEGORIES.flatMap(c => c.words.map(w => ({ word:w, category:c })));
      shuffle(remaining);
      render();
      setToast("");
      revealEl.classList.remove('show');
      statusEl.textContent = "Select 4 words, then submit.";
    }

    function shuffle(arr){
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function setToast(msg){
      if(!msg){
        toast.classList.remove('show');
        toast.textContent = "";
        return;
      }
      toast.textContent = msg;
      toast.classList.add('show');
    }

    function renderSolved(){
      solvedEl.innerHTML = "";
      for(const cat of solved){
        const div = document.createElement('div');
        div.className = 'group';
        div.style.background = COLOR_MAP[cat.color];

        const meta = document.createElement('div');
        meta.className = 'meta';
        meta.innerHTML = `
          <div class="label">${cat.color}</div>
          <div class="title">${cat.title}</div>
        `;

        const words = document.createElement('div');
        words.className = 'words';
        for(const w of cat.words){
          const chip = document.createElement('div');
          chip.className = 'chip';
          chip.textContent = w;
          words.appendChild(chip);
        }

        div.appendChild(meta);
        div.appendChild(words);
        solvedEl.appendChild(div);
      }
    }

    function renderGrid(){
      gridEl.innerHTML = "";
      for(const item of remaining){
        const btn = document.createElement('button');
        btn.className = 'tile';
        btn.type = 'button';
        btn.textContent = item.word;

        const isLocked = lockedWords.has(item.word);
        if(isLocked){
          btn.classList.add('locked');
          btn.disabled = true;
        } else {
          if(selected.has(item.word)) btn.classList.add('selected');
          btn.addEventListener('click', () => toggleSelect(item.word));
        }

        gridEl.appendChild(btn);
      }
    }

    function render(){
      renderSolved();
      renderGrid();
      submitBtn.disabled = selected.size !== 4;
      statusEl.textContent = selected.size === 0
        ? "Select 4 words, then submit."
        : `Selected: ${selected.size}/4`;
    }

    function toggleSelect(word){
      if(selected.has(word)){
        selected.delete(word);
      } else {
        if(selected.size >= 4) return;
        selected.add(word);
      }
      setToast("");
      render();
    }

    function deselectAll(){
      selected.clear();
      setToast("");
      render();
    }

    function submit(){
      if(selected.size !== 4) return;

      const picks = Array.from(selected);
      const cat = CATEGORIES.find(c => picks.every(w => c.words.includes(w)));
      if(!cat){
        setToast("Not quite. Try another set.");
        cardEl.classList.remove('shake');
        void cardEl.offsetWidth;
        cardEl.classList.add('shake');
        return;
      }

      if(solved.some(s => s.title === cat.title)){
        setToast("You already solved that one.");
        return;
      }

      solved.push(cat);
      remaining = remaining.filter(item => !cat.words.includes(item.word));
      for(const w of cat.words) lockedWords.add(w);

      selected.clear();
      setToast("Correct!");
      render();

      if(solved.length === 4){
        statusEl.textContent = "Perfect game.";
        revealEl.classList.add('show');
        revealEl.scrollIntoView({ behavior: "smooth", block: "center" });
      }
    }

    shuffleBtn.addEventListener('click', () => {
      shuffle(remaining);
      setToast("");
      render();
    });

    deselectBtn.addEventListener('click', deselectAll);
    submitBtn.addEventListener('click', submit);
    newBtn.addEventListener('click', initPuzzle);

    document.addEventListener('keydown', (e) => {
      if(e.key === 'Enter') submit();
      if(e.key === 'Escape') deselectAll();
    });

    initPuzzle();
  </script>
</body>
</html>
